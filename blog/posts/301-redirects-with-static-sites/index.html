<!DOCTYPE html>
<html lang="en">
  <!-- Head -->
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="#2d89ef">
    <meta name="msapplication-config" content="/assets/images/favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="/assets/images/favicon/site.webmanifest">
    <link rel="mask-icon" href="/assets/images/favicon/safari-pinned-tab.svg" color="#5270fb">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/lightbox.min.css">
    <link rel="stylesheet" href="/assets/css/google_fonts.min.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="alternate" href="/feed.xml" type="application/rss+xml">
    <!-- Begin Jekyll SEO tag v2.7.1 -->
    <title>Emma Sax | 301 Redirects with Static Sites</title>
    <meta name="generator" content="Jekyll v4.2.0" />
    <meta property="og:title" content="Emma Sax | 301 Redirects with Static Sites" />
    <meta name="author" content="Emma Sax" />
    <meta property="og:locale" content="en_US" />
    <meta name="description" content="Emma Sax‚Äôs personal website and blog. Includes information about my social media profiles, resum√©, and hobbies." />
    <meta property="og:description" content="Emma Sax‚Äôs personal website and blog. Includes information about my social media profiles, resum√©, and hobbies." />
    <link rel="canonical" href="https://emmasax4.com/blog/posts/301-redirects-with-static-sites/" />
    <meta property="og:url" content="https://emmasax4.com/blog/posts/301-redirects-with-static-sites/" />
    <meta property="og:site_name" content="Emma Sax" />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2020-10-04T17:00:00+00:00" />
    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="301 Redirects with Static Sites" />
    <meta name="google-site-verification" content="26aZscaByAlAXZ6gkemzbIXHuOdejckdx2AoZxjIU4c" />
    <meta name="msvalidate.01" content="89B2B19FF966341B78EF64EDADE6DF81" />
    <meta name="yandex-verification" content="8d24108cb36eee89" />
    <script type="application/ld+json">
      {"@type":"BlogPosting","description":"Emma Sax‚Äôs personal website and blog. Includes information about my social media profiles, resum√©, and hobbies.","headline":"301 Redirects with Static Sites","dateModified":"2020-11-10T14:41:47+00:00","datePublished":"2020-10-04T17:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://emmasax4.com/blog/posts/301-redirects-with-static-sites/"},"url":"https://emmasax4.com/blog/posts/301-redirects-with-static-sites/","author":{"@type":"Person","name":"Emma Sax"},"@context":"https://schema.org"}
    </script>
    <!-- End Jekyll SEO tag -->
  </head>
  <!-- Navigation bar -->
  <header class="sticky-top">
    <nav class="navbar navbar-expand-md navbar-dark py-0 py-md-0">
      <!-- Left hand side of navbar -->
      <a class="navbar-brand mb-0" href="/" target="_self">
        <img src="/assets/images/logos/e-logo-white-40.png" width="30" height="30" style="margin-top: 1px; margin-bottom: 1px;"
        class="d-inline-block align-top" alt="E logo"
      >&nbsp;&nbsp;Emma Sax
      </a>
      <!-- Navbar open/close button when on a smaller screen -->
      <button class="navbar-toggler" type="button" data-toggle="collapse"
      data-target="#navbar-links" aria-controls="navbar-links"
      aria-expanded="false" aria-label="Toggle navigation">
        <i data-feather="menu"></i>
        <i data-feather="x"></i>
      </button>
      <!-- Page links -->
      <div class="collapse navbar-collapse" id="navbar-links">
        <ul class="navbar-nav ml-auto mt-2 mt-md-0">
          <li class="nav-item ">
            <a class="nav-link" href="/about-me/">About Me
            </a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="/interests-and-hobbies/">Interests & Hobbies
            </a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">Blog
              <span class="sr-only">(current)</span>
            </a>
          </li>
        </ul>
      </div>
    </nav>
  </header>
  <!-- Page content -->
  <body>
    <main class="container">
      <div class="row">
        <div class="col col-12 col-md-10">
          <!-- Blog post title and information -->
          <div class="text-center">
            <h1 style="padding-bottom: .75rem;">
              301 Redirects with Static Sites
              <div class="row" style="margin-top: -.5rem;">
                <div class="col col-12 col-md-4">
                  <span class="post-meta">
                    <i style="width: 20px; height: 20px;" data-feather="tag"></i>
                    <a href="/blog/tech/">
                      tech
                    </a>
                  </span>
                </div>
                <div class="col col-12 col-md-4">
                  <span class="date-meta">2020-10-04 12:00:00 -0500</span>
                </div>
                <div class="col col-12 col-md-4">
                  <span class="post-meta">Read time: 10 minutes</span>
                </div>
              </div>
            </h1>
          </div>
          <!-- Blog post content and comments -->
          <div class="page-body">
            <p>This past weekend, I made the big decision to move the domain of my primary website from <code>https://emmasax4.info</code> to <code>https://emmasax4.com</code>. The main reason I wanted to do this was simply because I actually liked the idea of a <code>.com</code> domain. What I read online was that a <code>.com</code> domain is oftentimes the default, it‚Äôs what people tend to remember most, etc. The reason I originally purchased a <code>.info</code> domain was because I‚Äôm not a commercial business. I‚Äôm not trying to sell anything. But <code>.info</code> stands for ‚Äúinformation‚Äù, which I later learned was originally designated for information about a famous person, place, thing, or concept. Although I am a person, it just didn‚Äôt feel right. But somehow, one year into the revamping of this site and my ‚Äúbranding‚Äù, <code>emmasax4.com</code> just felt right. Whether any of this is true or not may be a debate on the internet for a while, but I figured, my website, my domain, my decision üí™üèº.</p>
            <p>Anyway, my domain isn‚Äôt what this blog post is supposed to be about. It‚Äôs supposed to be about the actual switch üîÅ. So, there were five 5Ô∏è‚É£ core things I realized I needed to do immediately to actually switch out the domains.</p>
            <p>Firstly, I needed to rename my repository (this repository). Doing this was actually pretty straightforward. Here‚Äôs the <a href="https://github.com/emmasax4/emmasax4.com/pull/305">pull request</a>. I used a selective find/replace, made the pull request, merged, and then changed the name in the settings of the repository üôåüèº.</p>
            <p>Secondly, I needed to actually change the website. This was a bit longer. I had to find/replace a bunch of places in the code, including in blog posts where I had hard-coded the website name (most likely as a code block). The other big things I had to do in this pull request was change the Google/Yandex tokens for my SEO crawlers (I had to add a ‚Äúnew‚Äù site to Google, Yandex, and Bing in order to have those search engines track the new domain)‚Äîmore on this later. I had to update the <code>CNAME</code> file as well, which is what would eventually tell GitHub Pages to do the full domain switch‚Äîthis became the third 3Ô∏è‚É£ item.</p>
            <p>Lastly, I removed a bunch of old blog post redirects (learn more about those redirects I set up <a href="/blog/posts/time-zones-utc-and-javascript-oh-my/">here</a>). Although it‚Äôd be nice if all of those continued redirecting nicely, I realized it wasn‚Äôt a priority anymore. What was a higher priority was making <code>https://emmasax4.info</code> redirect to <code>https://emmasax4.com</code>. This leads into the next item.</p>
            <p>Fourth, I needed to make redirects from the old site to the new site. And here is where I also learned that with a static site, there‚Äôs no super-easy way to make awesome redirects üòø.</p>
            <p>The tool that I use to set up my DNS has an easy way to set up redirects. They‚Äôre functional, and so that‚Äôs great. But, I wanted my redirects to be fancier. If somebody types in <code>https://emmasax4.info</code>, they should be redirected to <code>https://emmasax4.com</code>. But what if they pass in something like this: <code>https://emmasax4.info/path/to/webpage/</code>? They should be redirected to <code>https://emmasax4.com/path/to/webpage/</code>. And my DNS provider wasn‚Äôt capable of providing that service (transferring URL path when redirecting). So, I looked for simple, free, easy-to-implement alternatives that could redirect all URLs ü§î.</p>
            <p>What I found was <a href="https://opensource.com/article/19/7/permanently-redirect-github-pages">this solution</a> from Oleksii Tsvietnov. The idea is to make a new GitHub repository that will publish to GitHub Pages with the old domain. And then, create an <code>index.html</code> file which will redirect to the new domain. So, when a user navigates to the old domain, they‚Äôll hit the new GitHub Pages with your new <code>index.html</code>, and then it‚Äôll redirect automatically to the new domain (which is hosted on the original GitHub Pages repository) ü§Ø.</p>
            <p>I created <a href="https://github.com/emmasax4/emmasax4-redirects">this repository</a> to put my new redirects in. I started by taking a modified version of the HTML code in that blog post, which looked something like this:</p>
            <div class="language-html highlighter-rouge">
              <div class="highlight">
                <pre class="highlight"><code data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en-US"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title&gt;</span>Redirecting<span class="ni">&amp;hellip;</span><span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"canonical"</span> <span class="na">href=</span><span class="s">"https://destination-domain.com"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;script&gt;</span>
    <span class="nx">location</span><span class="o">=</span><span class="dl">"</span><span class="s2">https://destination-domain.com</span><span class="dl">"</span>
  <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"refresh"</span> <span class="na">content=</span><span class="s">"0; url=https://destination-domain.com"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"robots"</span> <span class="na">content=</span><span class="s">"noindex"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span>Redirecting<span class="ni">&amp;hellip;</span><span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://destination-domain.com"</span><span class="nt">&gt;</span>Click here if you are not redirected.<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
              </div>
            </div>
            <p>This worked. I duplicated each <code>index.html</code> file on the original site into this new project, replicating the files found <a href="https://github.com/emmasax4/emmasax4.com/tree/4c4aaed77f44ccf743ce47ddef9c91c9a89528a4">here</a>. But I realized this wasn‚Äôt sustainable. I didn‚Äôt want to be copy-pasting HTML from each file to another all over the place. I wanted <em>one</em> HTML file that would properly redirect any incoming path to the new domain, and forwarding the same path, without me having to make constant updates to the new redirect repository.</p>
            <p>Furthermore, I wanted users to know I was redirecting them. I didn‚Äôt want to do it under the hood, with them potentially not even noticing they were redirected. I wanted them to have a clear message they were being redirected, and for them to know that they were redirecting to a reputable new site. I wanted the redirect page to <em>look</em> like my existing website, so it was clear they were still within the realm of my original site.</p>
            <p>So, the first thing I did was add CSS. I copy-pasted the <code>./assets/</code> directory from <a href="https://github.com/emmasax4/emmasax4.com/tree/4171201807c9e217372dafd130543e5a2da79bba/assets">the main repository</a> to the new repository. I did a selective copy-paste, only copying the CSS, JS, and images that the new ‚Äúsite‚Äù required. And then I called those assets straight from my <code>index.html</code>, just like in my core repository. I opted not to include the full navigation bar, but just showing a basic blue top bar, to make it feel like it was still my website.</p>
            <div class="text-center">
              <a href="https://live.staticflickr.com/65535/50413992607_ef05913653_h.jpg" title="emmasax4.info redirecting" data-lightbox="Redirecting">
                <img class="image" src="https://live.staticflickr.com/65535/50413992607_ef05913653_h.jpg" width="300" alt="emmasax4.info redirecting">
              </a>
            </div>
            <p>And then the last couple tricks was to add two ways to do the redirect. One was a delayed redirect. So a user would sit on the redirect page for five seconds to be able to comprehend what was happening and then they‚Äôd be automatically redirected. The second was for an easy way for the user to redirect themselves. This eventually turned into a button. The tricky part of both of these was forwarding the incoming path. It turns out, the easiest way to do this is to actually use Javascript instead of HTML, like the original blog post suggests. For example, this is how you could read the incoming path that is navigated to, and pass it on in a delayed redirect:</p>
            <div class="language-js highlighter-rouge">
              <div class="highlight">
                <pre class="highlight"><code data-lang="js"><span class="nx">pathname</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span><span class="p">;</span>
<span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://destination-domain.com</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">pathname</span><span class="p">;},</span> <span class="mi">5000</span><span class="p">);</span>
</code></pre>
              </div>
            </div>
            <p>Now, with this Javascript, the key was to use it in two places: the button, and the delay. This was the ending solution:</p>
            <div class="language-html highlighter-rouge">
              <div class="highlight">
                <pre class="highlight"><code data-lang="html"><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
  <span class="kd">var</span> <span class="nx">pathname</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span><span class="p">;</span>

  <span class="c1">// Perform an automatic timed redirect</span>
  <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://destination-domain.com</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">pathname</span><span class="p">;},</span> <span class="mi">5000</span><span class="p">);</span>

  <span class="c1">// Add button click functionality as well</span>
  <span class="kd">function</span> <span class="nx">redirect_now</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://destination-domain.com</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">pathname</span><span class="p">;</span>
  <span class="p">};</span>
<span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"btn btn-lg btn-outline-secondary"</span> <span class="na">onclick=</span><span class="s">"redirect_now(); return false;"</span><span class="nt">&gt;</span>
  Click here if you are not redirected.
<span class="nt">&lt;/button&gt;</span>
</code></pre>
              </div>
            </div>
            <p>Bam! Now, no matter what path a user passes in after the <code>/</code>, they‚Äôll be forwarded to the exact same URL with just a different domain ü•≥. The last part of this project was to remove all of the extra <code>index.html</code> files. All we really need are the root <code>index.html</code> to catch when someone navigates to <code>https://emmasax4.info</code> directly, and a page to catch when somebody navigates to‚Ä¶. anything else (<code>https://emmasax4.info/anything/else/goes/here</code>). In that case, we can just make a <code>404.html</code> file. If the user navigates to anything else besides the plain root, then GitHub Pages will show the <code>404.html</code> page. And if the <code>404.html</code> functionality redirects to the new domain, <em>while passing the end of the path (<code>/anything/else/goes/here</code>)</em>, then the <code>404.html</code> page acts as a catch-all. So, I created a symlinked file off of the <code>index.html</code> page:</p>
            <div class="language-bash highlighter-rouge">
              <div class="highlight">
                <pre class="highlight"><code data-lang="bash"><span class="nb">ln</span> <span class="nt">-s</span> index.html 404.html
</code></pre>
              </div>
            </div>
            <p>This way, if I change one of the HTML files, it‚Äôll automatically change the other one. My final HTML files look like <a href="https://github.com/emmasax4/emmasax4-redirects/blob/13d56749a2675a667bce280c3c701e98453fd784/index.html">this</a>.</p>
            <p>The fifth step for me to do in the ‚Äúsoonish‚Äù future was to update my SEO trackers, indexers, and crawlers. I previously used Google Search Console, Bing, and Yandex to do my SEO tracking. In each of those, I had the option to add a new website or domain (<code>https://emmasax4.com</code>). And on Google, I also used the feature to do a ‚ÄúChange of Address.‚Äù So for Google, I added the new URL prefix site <em>and</em> completed the Change of Address. Google describes the use of that tool <a href="https://support.google.com/webmasters/answer/9370220?hl=en">here</a>.</p>
            <p>The next steps are to wait a few months. This is easy! Google recommends waiting a minimum of six months. Since I still own my old domain for a while, I‚Äôm probably going to keep my redirects alive as long as possible, which in my case will be over a year. I‚Äôll continue to monitor traffic, clicks, and impressions on tools like Cloudflare, Google Search Console, Yandex, and Bing. With any luck, the amount of traffic going towards the old domain will decrease within a few months, and the traffic on the new domain will increase. But after my waiting period is done, then I can turn off my redirects (in my case, turn off GitHub Pages on the <a href="https://github.com/emmasax4/emmasax4-redirects">redirecting repository</a>), and release or retire my old domain. If I so desire, I could keep the old domain forever and just eternally let it redirect‚Ä¶ it‚Äôs my choice.</p>
            <hr />
            <p>To summarize, the basic steps I used to change the domain on my static site with GitHub Pages:</p>
            <ol>
              <li>Rename the repository (<a href="https://github.com/emmasax4/emmasax4.com/pull/305">GitHub: emmasax4.com/pull/305</a>)</li>
              <li>Update where the project name is hard-coded (<a href="https://github.com/emmasax4/emmasax4.com/pull/306">GitHub: emmasax4.com/pull/306</a>)</li>
              <li>Change domain through GitHub Pages settings (or by merging the changes to the <code>CNAME</code> file) and set up SSL certificates for the new domain if needed</li>
              <li>Create redirects from old domain to new domain (<a href="https://github.com/emmasax4/emmasax4-redirects">GitHub: emmasax4-redirects</a>)</li>
              <li>Set up SEO trackers to monitor new domain</li>
              <li>Wait a several months and monitor traffic to old domain as you go</li>
              <li>(OPTIONAL) Turn off redirects</li>
              <li>(OPTIONAL) Release (or retire) old domain</li>
            </ol>
            <script src="/assets/js/show_comments.js" type="text/javascript"></script>
            <div class="text-center" style="margin-bottom: 1rem;">
              <button id="show-comments-button" class="btn btn-lg btn-outline-secondary"
            onclick="loadComments('emmasax4');return false;">
                Load Comments
                <i data-feather="message-circle"></i>
              </button>
            </div>
            <div id="disqus_thread"></div>
            <noscript>
              Please enable JavaScript to view the
              <a href="https://disqus.com/?ref_noscript" rel="nofollow">
                comments powered by Disqus.
              </a>
            </noscript>
          </div>
        </div>
        <div class="col col-12 col-md-2 text-center">
          <!-- Sidebar ‚Äì button to go back to all posts and RSS feed button -->
          <div class="text-center">
            <div class="container" style="padding-bottom: 1rem;">
              <a href="/blog/" class="btn btn-lg btn-outline-secondary">All Posts</a>
            </div>
            <a href="/feed.xml" target="_blank" class="link-icon-rss">
              <i data-feather="rss"></i>
            </a>
          </div>
        </div>
      </div>
    </main>
  </body>
  <!-- Footer -->
  <footer>
    &copy; <script>
      document.write(new Date().getFullYear());
    </script>
    Emma Sax. All rights reserved.
    <br>
    View on <a href="https://github.com/emmasax4/emmasax4.com">GitHub</a>.
  </footer>
  <!-- Javascript scripts -->
  <script src="/assets/js/show_dates.js" type="text/javascript"></script>
  <script src="/assets/js/external_links.js" type="text/javascript"></script>
  <script src="/assets/js/jquery.min.js"></script>
  <script src="/assets/js/lightbox.min.js"></script>
  <script src="/assets/js/bootstrap.min.js"></script>
  <script src="/assets/js/feather.min.js"></script>
  <script>
    feather.replace()
  </script>
</html>